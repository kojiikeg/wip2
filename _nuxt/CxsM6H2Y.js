import{q as j,A as k,r as f,o as c,c as C,a as t,u as l,F as v,w as r,d as p,V as m,G as _,b as V,H as A,I as H,t as w,s as J,J as L,z as S,y as R,p as z,f as M,_ as P}from"./BgyJECtJ.js";const h=d=>(z("data-v-d225d492"),d=d(),M(),d),q={class:"main"},E=h(()=>t("h1",null,"お知らせ一覧",-1)),F=h(()=>t("br",null,null,-1)),G={class:"menu"},O={key:0},K=h(()=>t("br",null,null,-1)),Q=["onClick"],W=["innerHTML"],X={class:"date"},Y=j({__name:"index",async setup(d){let n,u;const x=S().public.apiUrl,D=([n,u]=k(()=>fetch(x+"/notice")),n=await n,u(),n),y=([n,u]=k(()=>D.json()),n=await n,u(),n);function N(e){return e.slice(0,100)+(e.length>100?"...":"")}const b=f(y),i=f(y),g=f(!1),o=f(!1),B=e=>o.value?`cursor: grab; background-color: ${e?"#f9f9f9":"#f0f0f0"}`:`cursor: pointer; background-color:  ${e?"#f9f9f9":"#f0f0f0"}`;function U(e){const s={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("ja-JP",s)}const $=async()=>{o.value=!1,g.value=!0;const s=S().public.apiUrl;(await fetch(s+"/notice/list",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i.value)})).ok?(b.value=i.value,g.value=!1):alert("順序の変更に失敗しました。リロードしてやり直すか、管理者に連絡してください。")},I=()=>{o.value=!1,i.value=b.value},T=e=>{R().push(`/admin/notices/edit/${e}`)};return(e,s)=>(c(),C("div",q,[t("div",null,[E,F,t("div",G,[l(o)?_("",!0):(c(),v(m,{key:0,disabled:l(g),onClick:s[0]||(s[0]=a=>o.value=!0),color:"blue"},{default:r(()=>[p(" 順序の入替 ")]),_:1},8,["disabled"])),l(o)?(c(),v(m,{key:1,onClick:$,color:"green"},{default:r(()=>[p(" 入替を反映 ")]),_:1})):_("",!0),l(o)?(c(),v(m,{key:2,onClick:I,color:"red"},{default:r(()=>[p(" 入替を中止 ")]),_:1})):_("",!0)]),l(o)?(c(),C("div",O,[K,V(A,{type:"info",variant:"tonal"},{default:r(()=>[p(" ドラッグ&ドロップで順序を変更できます。 変更後は上のボタンで反映・中止できます。 ")]),_:1})])):_("",!0)]),t("div",null,[V(l(L),{disabled:!l(o),modelValue:l(i),"onUpdate:modelValue":s[1]||(s[1]=a=>J(i)?i.value=a:null),group:"people","item-key":"id"},{item:r(({element:a})=>[t("div",{style:H(B(a.visible)),onClick:ee=>T(a.id),class:"list"},[t("h2",null,w(a.title),1),t("p",{innerHTML:e.$md.render(N(a.content))},null,8,W),t("p",X,w(U(a.createDate)),1)],12,Q)]),_:1},8,["disabled","modelValue"])])]))}}),oe=P(Y,[["__scopeId","data-v-d225d492"]]);export{oe as default};
